$targetPath = "D:\Softrack\HRSuite\"
$excludedFiles = @("8028.aspx", "8028.html")

# Delete files, excluding specific names
Get-ChildItem -Path $targetPath -File -Recurse | ForEach-Object {
    if ($excludedFiles -notcontains $_.Name) {
        try {
            Remove-Item -Path $_.FullName -Force
            Write-Host "Deleted file: $($_.FullName)"
        } catch {
            Write-Host "Error deleting file $($_.FullName): $_"
        }
    } else {
        Write-Host "Skipped file: $($_.FullName)"
    }
}

# Delete all empty folders (bottom-up)
Get-ChildItem -Path $targetPath -Directory -Recurse | Sort-Object -Property FullName -Descending | ForEach-Object {
    try {
        Remove-Item -Path $_.FullName -Force -Recurse -ErrorAction Stop
        Write-Host "Deleted folder: $($_.FullName)"
    } catch {
        Write-Host "Could not delete folder $($_.FullName): $_"
    }
}
